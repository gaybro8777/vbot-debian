using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

using Newtonsoft.Json;

namespace vbot.core
{ 
    public class OSSIndexVulnerability
    {
        [JsonProperty("action")]
        public string Action { get; set; }

        [JsonProperty("url")]
        public string Url { get; set; }

        [JsonProperty("title")]
        public string Title { get; set; } = "";

        [JsonProperty("description")]
        public string Description { get; set; }

        [JsonProperty("package_manager")]
        public string PackageManager { get; set; }

        [JsonProperty("group")]
        public string Group { get; set; }

        [JsonProperty("name")]
        public string Name { get; set; }

        [JsonProperty("version")]
        public string Version { get; set; }

        [JsonProperty("cves")]
        public string[] CVEs { get; set; }

        [JsonProperty("vid")]
        public string Vid { get; set; } = "";

        [JsonProperty("references")]
        public string[] References { get; set; } = { };

        public bool EqualValues(OSSIndexVulnerability r)
        {
            return JsonConvert.SerializeObject(this) == JsonConvert.SerializeObject(r);
        }

    }
}
